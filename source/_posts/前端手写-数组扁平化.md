---
title: å‰ç«¯æ‰‹å†™-æ•°ç»„æ‰å¹³åŒ–
date: 2022-09-15 23:05:32
tags:
- å„ç§æ— å˜å¤´æ‰‹å†™
---
é¢˜ç›®æè¿°ï¼š
å·²æœ‰å¤šçº§åµŒå¥—æ•°ç»„ : [1, [2, [3, [4, 5]]], 6] å°†å…¶æ‰å¹³åŒ–å¤„ç† è¾“å‡º: [1,2,3,4,5,6]

é¢˜ç›®è€ƒæŸ¥çš„å†…å®¹å°±æ˜¯æ•°ç»„æ‰å¹³åŒ–ï¼Œä»€ä¹ˆæ˜¯æ‰å¹³åŒ–å‘¢ï¼Ÿ
<mark>æ‰å¹³åŒ–ï¼šå°±æ˜¯å°†å¤šç»´æ•°ç»„å˜æˆä¸€ç»´æ•°ç»„ï¼Œä¸å­˜åœ¨æ•°ç»„çš„åµŒå¥—</mark>

### æ‰å¹³åŒ–çš„æ–¹æ³•ï¼š
1. ES6 flat
2. toString
3. æ­£åˆ™æ›¿æ¢
4. å¾ªç¯é€’å½’ï¼šå¾ªç¯+concat+push / ä½¿ç”¨å‚æ•°æ§åˆ¶æ‰å¹³åŒ–æ·±åº¦ / reduce / generator
5. ä½¿ç”¨æ ˆç»“æ„
6. whileå¾ªç¯+some
 
#### 1.ES6 flat
`flat(depth)` æ–¹æ³•ä¼šæŒ‰ç…§ä¸€ä¸ªå¯æŒ‡å®šçš„æ·±åº¦é€’å½’éå†æ•°ç»„ï¼Œå¹¶å°†æ‰€æœ‰å…ƒç´ ä¸éå†åˆ°çš„å­æ•°ç»„ä¸­çš„å…ƒç´ åˆå¹¶ä¸ºä¸€ä¸ªæ–°æ•°ç»„è¿”å›ã€‚
ğŸŒŸ å‚æ•°ï¼š`depth`ï¼ˆå¯é€‰ï¼‰æŒ‡å®šè¦æå–åµŒå¥—æ•°ç»„çš„ç»“æ„æ·±åº¦ï¼Œé»˜è®¤å€¼ä¸º1
ğŸŒŸ è¿”å›å€¼ï¼šè¿”å›ä¸€ä¸ªæ–°æ•°ç»„ï¼Œå¯å±•å¼€ä»»æ„æ·±åº¦çš„åµŒå¥—æ•°ç»„
```javascript
 let res = arr.flat(Infinity);
```

#### 2.toStringæ–¹æ³•
```javascript
function _flatten(arr){
  return arr.toString().split(',').map(item=>parseFloat(item));
}
```

#### 3.æ­£åˆ™æ›¿æ¢
çœ‹åˆ°åµŒå¥—æ•°ç»„ï¼Œä»å­—ç¬¦ä¸²çš„è§’åº¦ä¸Šçœ‹å°±æ˜¯å¤šäº†å¾ˆå¤šçš„`[`å’Œ`]`ï¼Œå°†å®ƒä»¬æ›¿æ¢å°±å¯ä»¥å®ç°ç®€å•çš„æ‰å¹³åŒ–
```javascript
function _flatten(arr){
  let str = JSON.stringify(arr).replace(/(\[|\])/g,'');
  str = '['+str+']';
  arr = JSON.parse(str);
  return arr;
}
```

#### 4.å¾ªç¯é€’å½’
##### 4.1 å¾ªç¯+concat+push
ğŸŒŸæ€è·¯ï¼š
1. å¾ªç¯åˆ¤æ–­æ•°ç»„çš„æ¯ä¸€é¡¹æ˜¯å¦æ˜¯æ•°ç»„: `Array.isArray(arr[i])`
2. æ˜¯æ•°ç»„å°±é€’å½’è°ƒç”¨ä¸Šé¢çš„æ‰å¹³åŒ–ä¸€å±‚çš„ä»£ç  `result = result.concat(flatten(arr[i]));`
3. ä¸æ˜¯æ•°ç»„,ç›´æ¥é€šè¿‡`push`æ·»åŠ åˆ°è¿”å›å€¼æ•°ç»„

```javascript
function _flatten(arr) {
  let result = [];
  for (let i = 0; i < arr.length; i++) {
    if (Array.isArray(arr[i])) {
      result = result.concat(flatten(arr[i]));
    } else {
      result.push(arr[i])
    }
  }
  return result
}

// forEachç‰ˆæœ¬
// é€’å½’ç‰ˆæœ¬çš„ååµŒå¥—
function flatten(array) {
  var flattend = [];
  (function flat(array) {
    array.forEach(function(el) {
      if (Array.isArray(el)) flat(el);
      else flattend.push(el);
    });
  })(array);
  return flattend;
}
```
##### 4.2 ä½¿ç”¨å‚æ•°æ§åˆ¶æ‰å¹³åŒ–æ·±åº¦
ğŸŒŸï¼šæ‰‹å†™flat()æ–¹æ³•
```javascript
// forEach éå†æ•°ç»„ä¼šè‡ªåŠ¨è·³è¿‡ç©ºå…ƒç´ 
const _flat = (arr = [], depth = 1) => {
  const result = []; // ç¼“å­˜é€’å½’ç»“æœ
  // å¼€å§‹é€’å½’
  (function flat(arr, depth) {
    // forEach ä¼šè‡ªåŠ¨å»é™¤æ•°ç»„ç©ºä½
    arr.forEach((item) => {
      // æ§åˆ¶é€’å½’æ·±åº¦
      if (Array.isArray(item) && depth > 0) {
        // é€’å½’æ•°ç»„
        flat(item, depth - 1)
      } else {
        // ç¼“å­˜å…ƒç´ 
        result.push(item)
      }
    })
  })(arr, depth)
  // è¿”å›é€’å½’ç»“æœ
  return result;
}
```

##### 4.3 å·§ç”¨reduce
`reduce` æ–¹æ³•ä¸ºæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ æŒ‰åºæ‰§è¡Œä¸€ä¸ªreducerå‡½æ•°ï¼Œæ¯ä¸€æ¬¡è¿è¡Œ reducer ä¼šå°†å…ˆå‰å…ƒç´ çš„è®¡ç®—ç»“æ„ä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œæœ€åå°†å…¶ç»“æœæ±‡æ€»ä¸ºå•ä¸ªè¿”å›å€¼ã€‚
```javascript
const arr = [1, [[2, 3], 4],5]
const flatten = (arr, deep = 1) => {
    if (deep <= 0) return arr;
    return arr.reduce((res, curr) => res.concat(Array.isArray(curr) ? flatten(curr, deep - 1) : curr), [])
}
// function flatten (arr,deep=1) {
// return   arr.reduce((acc,val) => acc.concat(Array.isArray(val)? flatten(val,deep-1):val),[])
// }
console.log(arr, Infinity);
// è¾“å‡º:[ 1, 2, 3, 4, 5, 6 ]
```

##### 4.4 ä½¿ç”¨Generatorå‡½æ•°

GeneratorFunctionæ˜¯åç¨‹åœ¨ ES6 çš„å®ç°ï¼Œæœ€å¤§ç‰¹ç‚¹å°±æ˜¯å¯ä»¥äº¤å‡ºå‡½æ•°çš„æ‰§è¡Œæƒï¼ˆå³æš‚åœæ‰§è¡Œï¼‰ã€‚å®ƒä¸åŒäºæ™®é€šå‡½æ•°ï¼Œæ˜¯å¯ä»¥æš‚åœæ‰§è¡Œçš„ï¼Œæ‰€ä»¥å‡½æ•°åä¹‹å‰è¦åŠ æ˜Ÿå·ï¼Œä»¥ç¤ºåŒºåˆ«ã€‚æ•´ä¸ª Generator å‡½æ•°å°±æ˜¯ä¸€ä¸ªå°è£…çš„å¼‚æ­¥ä»»åŠ¡ï¼Œæˆ–è€…è¯´æ˜¯å¼‚æ­¥ä»»åŠ¡çš„å®¹å™¨ã€‚å¼‚æ­¥æ“ä½œéœ€è¦æš‚åœçš„åœ°æ–¹ï¼Œéƒ½ç”¨ yield è¯­å¥æ³¨æ˜ã€‚Generator å‡½æ•°çš„æ‰§è¡Œæ–¹æ³•å¦‚ä¸‹ã€‚
æ„é€ å™¨ç”Ÿæˆæ–°çš„ç”Ÿæˆå™¨å‡½æ•°ã€‚
```javascript
function* flatten(array) {
    for (const item of array) {
        if (Array.isArray(item)) {
            yield* flatten(item);
        } else {
            yield item;
        }
    }
}

```

#### 5.ä½¿ç”¨æ ˆç»“æ„
ğŸª æ€è·¯ï¼š
1. æŠŠæ•°ç»„é€šè¿‡ä¸€ä¸ªæ ˆæ¥ç»´æŠ¤
2. å½“æ ˆä¸ä¸ºç©ºçš„æ—¶å€™å¾ªç¯æ‰§è¡Œå¤„ç†
3. pop()å°†æ ˆå°¾å‡ºæ ˆ
4. å¦‚æœå‡ºæ ˆçš„å…ƒç´ æ˜¯æ•°ç»„,å°±å°†è¯¥å…ƒç´ è§£æ„åæ¯ä¸€å…ƒç´ è¿›è¡Œå…¥æ ˆæ“ä½œ
5. å‡ºæ ˆçš„å…ƒç´ ä¸æ˜¯æ•°ç»„å°±pushè¿›è¿”å›å€¼res
6. åè½¬æ¢å¤åŸæ•°ç»„çš„é¡ºåº

```javascript
var arr1 = [1,2,3,[1,2,3,4, [2,3,4]]];
function flatten(arr) {
  const stack = [...arr];
  const res = [];
  while (stack.length) {
    // ä½¿ç”¨ pop ä» stack ä¸­å–å‡ºå¹¶ç§»é™¤å€¼
    const next = stack.pop();
    if (Array.isArray(next)) {
      // ä½¿ç”¨ push é€å›å†…å±‚æ•°ç»„ä¸­çš„å…ƒç´ ï¼Œä¸ä¼šæ”¹åŠ¨åŸå§‹è¾“å…¥
      stack.push(...next);
    } else {
      res.push(next);
    }
  }
  // åè½¬æ¢å¤åŸæ•°ç»„çš„é¡ºåº
  return res.reverse();
}
flatten(arr1);// [1, 2, 3, 1, 2, 3, 4, 2, 3, 4]
```

#### 6.whileå¾ªç¯+someæ–¹æ³•
some :æ–¹æ³•æµ‹è¯•æ•°ç»„ä¸­æ˜¯ä¸æ˜¯è‡³å°‘æœ‰ 1 ä¸ªå…ƒç´ é€šè¿‡äº†è¢«æä¾›çš„å‡½æ•°æµ‹è¯•ã€‚å®ƒè¿”å›çš„æ˜¯ä¸€ä¸ª Boolean ç±»å‹çš„å€¼ã€‚

ğŸª æ€è·¯ï¼š
é€šè¿‡`some`æ¥åˆ¤æ–­æ•°ç»„ä¸­æ˜¯å¦ç”¨æ•°ç»„,é€šè¿‡`while`ä¸æ–­å¾ªç¯æ‰§è¡Œåˆ¤æ–­, å¦‚æœæ˜¯æ•°ç»„çš„è¯å¯ä»¥ä½¿ç”¨ `æ‹“å±•è¿ç®—ç¬¦...` æ¯æ¬¡åªèƒ½å±•å¼€æœ€å¤–å±‚çš„æ•°ç»„,åŠ ä¸Š`contact`æ¥å‡å°‘åµŒå¥—å±‚æ•°

```javascript
function flatten(arr) {
  while (arr.some(item=> Array.isArray(item))) {
    console.log(...arr)
    arr = [].concat(...arr)
    console.log(arr)
  }
  return arr
}
console.log(flatten(arr));
```